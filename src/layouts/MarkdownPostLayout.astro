---
import type { Frontmatter } from "../content.config";
import BaseLayout from "./BaseLayout.astro";
import Divider from "../components/Divider.astro";

type Props = {
    frontmatter: Frontmatter;
};

const { frontmatter } = Astro.props;

const pageTitle = `${frontmatter.title}`;
const imageUrl = `url(${frontmatter.image?.url})`
---

<BaseLayout pageTitle={pageTitle}>
    <article class="content-container">
        <header class="wide">
            <h1>{frontmatter.title}</h1>
            <time datetime={frontmatter.pubDate.toISOString().slice(0, 10)} class="pub-date">{frontmatter.pubDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</time>
            <p class="description">{frontmatter.description}</p>
        </header>

        <slot />

        
        <footer class="wide">
            <Divider />
            <p>
                You can share your thoughts on this post via <a href=`mailto:hi@timsblog.dev?subject=Comment on "${frontmatter.title}"`>e-mail</a>.
            </p>

            <a href="#site-header" class="top-link" id="top-link" aria-label="Scroll back to top">
                <svg role="presentation" focusable="false" xmlns="http://www.w3.org/2000/svg" width="13" height="17" viewBox="0 0 13 17">
                    <path fill="currentColor" d="M6.5 0L0 6.5 1.4 8l4-4v12.7h2V4l4.3 4L13 6.4z"></path>
                </svg> back to top
            </a>
        </footer>
    </article>

    <script is:inline>
        const topLink = document.getElementById('top-link');
        function handleScroll() {
            const scrolled = window.scrollY;
            const trigger = window.innerHeight;
            if (scrolled > trigger) {
                topLink.classList.add('fixed');
            } else {
                topLink.classList.remove('fixed');
            }
        }
        window.addEventListener('scroll', handleScroll);
    </script>

<style define:vars={{ imageUrl }}>
    .pub-date {
        display: block;
        font-size: 0.9em;
        color: var(--secondary-text);
    }

    header {
        padding: 2.5rem 0;
    }

    header .description {
        margin-top: 2.5rem;
        color: var(--secondary-text);
        font-size: 1.3em;
    }

    footer {
        padding: 2.5rem 0;
    }

    .top-link {
        /* display: none; */
        text-decoration: none;
        font-size: 1rem;
    }

    .top-link svg {
        display: inline;
        margin-right: 0.2em;
    }

    @media (min-width: 170ch) {
        .top-link.fixed {
            /* position: fixed;
            left: 50%;
            transform: translateX(-70ch);
            bottom: 1.5rem; */
            /* grid-column: wide; */
            position: fixed;
            bottom: 1.5rem;
        }
    }
</style>
